---
title: Characterizing Large Language Model Geometry Helps Solve Toxicity Detection
  and Generation
openreview: glfcwSsks8
abstract: 'Large Language Models (LLMs) drive current AI breakthroughs despite very
  little being known about their internal representations. In this work, we propose
  to shed the light on LLMs inner mechanisms through the lens of geometry. In particular,
  we develop in closed form $(i)$ the intrinsic dimension in which the Multi-Head
  Attention embeddings are constrained to exist and $(ii)$ the partition and per-region
  affine mappings of the feedforward (MLP) network of LLMs’ layers. Our theoretical
  findings further enable the design of novel principled solutions applicable to state-of-the-art
  LLMs. First, we show that, through our geometric understanding, we can bypass LLMs’
  RLHF protection by controlling the embedding’s intrinsic dimension through informed
  prompt manipulation. Second, we derive interpretable geometrical features that can
  be extracted from any (pre-trained) LLM, providing a rich abstract representation
  of their inputs. We observe that these features are sufficient to help solve toxicity
  detection, and even allow the identification of various types of toxicity. Our results
  demonstrate how, even in large-scale regimes, exact theoretical results can answer
  practical questions in LLMs. Code: https://github.com/RandallBalestriero/SplineLLM'
layout: inproceedings
series: Proceedings of Machine Learning Research
publisher: PMLR
issn: 2640-3498
id: balestriero24a
month: 0
tex_title: Characterizing Large Language Model Geometry Helps Solve Toxicity Detection
  and Generation
firstpage: 2543
lastpage: 2565
page: 2543-2565
order: 2543
cycles: false
bibtex_author: Balestriero, Randall and Cosentino, Romain and Shekkizhar, Sarath
author:
- given: Randall
  family: Balestriero
- given: Romain
  family: Cosentino
- given: Sarath
  family: Shekkizhar
date: 2024-07-08
address:
container-title: Proceedings of the 41st International Conference on Machine Learning
volume: '235'
genre: inproceedings
issued:
  date-parts:
  - 2024
  - 7
  - 8
pdf: https://proceedings.mlr.press/v235/balestriero24a/balestriero24a.pdf
extras: []
# Format based on Martin Fenner's citeproc: https://blog.front-matter.io/posts/citeproc-yaml-for-bibliographies/
---
