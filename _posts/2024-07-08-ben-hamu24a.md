---
title: 'D-Flow: Differentiating through Flows for Controlled Generation'
openreview: SE20BFqj6J
abstract: 'Taming the generation outcome of state of the art Diffusion and Flow-Matching
  (FM) models without having to re-train a task-specific model unlocks a powerful
  tool for solving inverse problems, conditional generation, and controlled generation
  in general. In this work we introduce <em>D-Flow</em>, a simple framework for controlling
  the generation process by differentiating through the flow, optimizing for the source
  (noise) point. We motivate this framework by our key observation stating that for
  Diffusion/FM models trained with Gaussian probability paths, differentiating through
  the generation process projects gradient on the data manifold, implicitly injecting
  the prior into the optimization process. We validate our framework on linear and
  non-linear controlled generation problems including: image and audio inverse problems
  and conditional molecule generation reaching state of the art performance across
  all.'
layout: inproceedings
series: Proceedings of Machine Learning Research
publisher: PMLR
issn: 2640-3498
id: ben-hamu24a
month: 0
tex_title: 'D-Flow: Differentiating through Flows for Controlled Generation'
firstpage: 3462
lastpage: 3483
page: 3462-3483
order: 3462
cycles: false
bibtex_author: Ben-Hamu, Heli and Puny, Omri and Gat, Itai and Karrer, Brian and Singer,
  Uriel and Lipman, Yaron
author:
- given: Heli
  family: Ben-Hamu
- given: Omri
  family: Puny
- given: Itai
  family: Gat
- given: Brian
  family: Karrer
- given: Uriel
  family: Singer
- given: Yaron
  family: Lipman
date: 2024-07-08
address:
container-title: Proceedings of the 41st International Conference on Machine Learning
volume: '235'
genre: inproceedings
issued:
  date-parts:
  - 2024
  - 7
  - 8
pdf: https://proceedings.mlr.press/v235/assets/ben-hamu24a/ben-hamu24a.pdf
extras: []
# Format based on Martin Fenner's citeproc: https://blog.front-matter.io/posts/citeproc-yaml-for-bibliographies/
---
